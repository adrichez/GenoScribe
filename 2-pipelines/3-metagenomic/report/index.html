<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Metagenomic Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-c3c2c9e745155556954bc4da23476b10.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-73f4ae0f6692eb10e1c82046125d5af1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link rel="shortcut icon" href="resources/1-essential/1-images/icons/favicon.svg">
<link rel="icon" type="image/x-icon" href="resources/1-essential/1-images/icons/favicon.ico">


<link rel="stylesheet" href="resources/1-essential/3-scripts/3-css/styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><img class="brand-logo" src="./resources/1-essential/1-images/icons/ipbln_background.png"> <a class="brand-text" href="https://www.ipb.csic.es/servicios/Bioinformatica/index.html">IPBLN</a></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> <i class="bi bi-house" role="img">
</i> 
<span class="menu-text">Inicio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./resources/1-essential/3-scripts/2-quarto/1-full-version/tab1-metodologia/metodologia.qmd"> <i class="bi bi-wrench" role="img">
</i> 
<span class="menu-text">Metodología</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./resources/1-essential/3-scripts/2-quarto/1-full-version/tab2-resumen/tab2-1-resumen-16S/resumen.qmd"> <i class="bi bi-clipboard-data" role="img">
</i> 
<span class="menu-text">Resumen 16S</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-análisis-16s" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-bar-chart" role="img">
</i> 
 <span class="menu-text">Análisis 16S</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-análisis-16s">    
        <li>
    <a class="dropdown-item" href="./resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/0-contexto.qmd">
 <span class="dropdown-text">➤ Introducción contextual</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/1-revision-inicial.qmd">
 <span class="dropdown-text">1. Revisión inicial de muestras y metadatos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/2-control-calidad.qmd">
 <span class="dropdown-text">2. Control de calidad y preprocesamiento</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/3-generacion-asvs.qmd">
 <span class="dropdown-text">3. Generación de ASVs y tabla de abundancia</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/4-taxonomia-filogenia.qmd">
 <span class="dropdown-text">4. Asignación taxonómica y filogenia</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/5-analisis-diferencial.qmd">
 <span class="dropdown-text">5. Análisis diferencial de abundancia</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/6-diversidad-microbiana.qmd">
 <span class="dropdown-text">6. Diversidad microbiana</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/7-prediccion-funcional.qmd">
 <span class="dropdown-text">7. Predicción funcional</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./resources/1-essential/3-scripts/2-quarto/1-full-version/tab3-analisis/tab3-1-analisis-16S/8-conclusiones.qmd">
 <span class="dropdown-text">8. Conclusiones y perspectivas</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-layout-custom page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
<!-- main -->

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Metagenomic Report</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  CHATBOT
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!-- Contenedor del chat -->
<div id="chat-container">
  <button id="chat-toggle"></button>
  <div id="chat-box">
    <div id="chat-info" class="chat-info">
      <h1>
        Mini Chat RAG (beta)
      </h1>

      <p>
        Este chat permite consultar de manera interactiva la información contenida en un informe específico. 
        Para ello, se ha alimentado el sistema con el contenido del propio informe, junto con documentos externos en formato PDF y HTML, así como sesiones de preguntas y respuestas (QA). 
        Al formular una pregunta, el chat busca los fragmentos más relevantes de todos estos documentos mediante técnicas de procesamiento de lenguaje natural ligero y comparaciones basadas en similitud de vectores (medida de coseno). 
        A partir de los fragmentos seleccionados, se genera un resumen que intenta ofrecer una respuesta coherente y compacta a la consulta realizada.
      </p>

      <p>
        Se debe tener en cuenta que este entorno es de prueba. No se utilizan grandes modelos de lenguaje, por lo que las respuestas pueden ser aproximadas y no siempre completamente precisas. 
        El objetivo principal es proporcionar una visualización rápida y útil de la información contenida en los documentos, facilitando la exploración del contenido del informe de manera interactiva.
      </p>
      
      <p>
        Actualmente, los resultados no son muy precisos debido al uso de modelos muy básicos, seleccionados para que la aplicación sea rápida y ejecutable en todo tipo de dispositivos sin necesidad de servidores externos. 
        Sin embargo, la base del sistema permite mejorar notablemente los resultados en el futuro mediante el uso de modelos más potentes o la integración con APIs externas, ofreciendo así un rendimiento y precisión significativamente superiores.
        Para iniciar, basta con escribir su pregunta en el campo de texto inferior.
      </p>
    </div>
    <div id="chat-log"></div>
    <input id="chat-input" type="text" placeholder="Escribe tu pregunta...">
    <button id="chat-send" title="Enviar">
      <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
        <path d="M2 21l21-9L2 3v7l15 2-15 2v7z"></path>
      </svg>
    </button>
  </div>
</div>
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  TAB 1: INICIO -->
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<div class="informe-titulo">
<h1>
Informe Automatizado de Metagenómica
</h1>
<p>
Generado con Nextflow + Quarto · IPBLN-CSIC · Granada
</p>
</div>
<div class="portada-imagen">
<p><img src="resources/1-essential/1-images/tab0-inicio/metagenomic_cover.jpg" alt="Portada Metagenómica"></p>
</div>
<div class="informe-resumen">
<h2>
Contexto y pipelines empleados
</h2>
<p>
La <strong>metagenómica de amplicones</strong> es un enfoque utilizado para estudiar la composición y diversidad de comunidades microbianas sin necesidad de aislar organismos individuales. Se basa en la secuenciación de regiones conservadas de genes marcador, que permiten identificar taxones presentes en una muestra ambiental, clínica o experimental. Los marcadores más habituales son:
</p>
<ul>
<li>
<strong>16S rRNA</strong>: utilizado para identificar bacterias y arqueas. Es el enfoque principal de este informe.
</li>
<li>
<strong>18S rRNA</strong>: utilizado para caracterizar eucariotas (protozoos, hongos y otros microeucariotas), planeado para futuras extensiones del estudio.
</li>
<li>
<strong>ITS (Internal Transcribed Spacer)</strong>: utilizado principalmente para identificación de hongos a nivel de especie, también considerado para futuras ampliaciones.
</li>
</ul>
<p>
Este informe se centra en el análisis de <strong>16S</strong>, mientras que los datos de <strong>18S e ITS</strong> quedan comentados y mencionados para posibles ampliaciones en nuevas pestañas del informe, permitiendo una extensión del estudio de forma modular y reproducible.
</p>
<p>
Los datos utilizados en este informe provienen de:
</p>
<ul>
<li>
<strong>Control de calidad inicial</strong>: realizado mediante <strong>miARma‑Seq</strong> (<em>Eduardo Andrés-León et al.</em>), un pipeline modular y completo diseñado para análisis de RNA-Seq que incluye pasos de recorte, alineamiento, cuantificación y análisis diferencial. Dado que miARma‑Seq no está pensado específicamente para metagenómica, en este informe se ha utilizado únicamente para procesar datos de <code>FASTQ</code> y generar informes de <em>FastQC</em> y <em>MultiQC</em> para evaluar la calidad de las lecturas. Toda la información y documentación de miARma-Seq está disponible en su <a href="https://github.com/eandresleon/miARma-seq" class="normalink" target="_blank">repositorio oficial</a>.
</li>
<li>
<strong>Análisis metagenómico principal</strong>: llevado a cabo con <strong>QIIME2</strong>, que permite denoising de lecturas, construcción de tablas de abundancia, cálculo de métricas de diversidad, análisis funcional y visualización integrada. QIIME2 es una plataforma reproducible y documentada, diseñada específicamente para metagenómica de amplicones, disponible en <a href="https://qiime2.org/" class="normalink" target="_blank">https://qiime2.org/</a>.
</li>
</ul>
<p>
Para ambas herramientas, más adelante se comentará el pipeline completo de manera detallada, incluyendo todos los pasos posibles y su integración en el flujo de trabajo automatizado de este informe.
</p>
<p>
El flujo de trabajo completo combina estas herramientas de la siguiente manera:
</p>
<ol>
<li>
<strong>Control de calidad inicial</strong>: evaluación de lecturas crudas mediante <em>FastQC</em> y resúmenes globales con <em>MultiQC</em> generados por <strong>miARma‑Seq</strong>.
</li>
<li>
<strong>Procesamiento metagenómico</strong>: análisis exclusivo de <strong>16S</strong> con <em>QIIME2</em>, incluyendo filtrado, denoising con <em>DADA2</em>, generación de tablas de abundancia y visualizaciones preliminares.
</li>
<li>
<strong>Análisis de diversidad y funcionalidad</strong>: cálculo de métricas α y β de diversidad, visualizaciones con PCoA, predicción funcional de metagenomas mediante <em>PICRUSt2</em> y análisis estadístico con <em>R</em> usando paquetes como <em>MetagenomeSeq</em> o <em>ALDEx2</em>.
</li>
<li>
<strong>Informe automatizado</strong>: integración de todos los resultados en un reporte reproducible en <strong>HTML</strong> mediante <strong>Quarto</strong>, incluyendo gráficos, tablas y resúmenes de cada etapa.
</li>
</ol>
<p>
Como ya se ha mencionado, por el momento, los análisis de <strong>18S e ITS</strong> se encuentran comentados y mencionados únicamente como referencia. Estas secciones podrán incorporarse en futuras pestañas del informe, manteniendo la misma estructura modular y reproducible que caracteriza el pipeline.
</p>
<table style="width:100%; border-collapse: collapse; margin-top: 1.5em;">
<thead>
<tr style="background-color: #f2f2f2;">
<th style="border: 1px solid #ddd; padding: 8px;">
Característica
</th>
<th style="border: 1px solid #ddd; padding: 8px;">
Beneficio
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">
<strong>Automatización</strong>
</td>
<td style="border: 1px solid #ddd; padding: 8px;">
Permite generar informes reproducibles sin intervención manual en cada paso.
</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">
<strong>Modularidad</strong>
</td>
<td style="border: 1px solid #ddd; padding: 8px;">
Cada etapa del flujo (QC, denoising, diversidad, funcionalidad) puede ejecutarse de forma independiente o completa.
</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">
<strong>Integración QIIME2 + R</strong>
</td>
<td style="border: 1px solid #ddd; padding: 8px;">
Permite combinar análisis bioinformático y estadístico con visualización reproducible.
</td>
</tr>
<tr>
<td style="border: 1px solid #ddd; padding: 8px;">
<strong>Flexibilidad</strong>
</td>
<td style="border: 1px solid #ddd; padding: 8px;">
Se puede ampliar el estudio a otros marcadores (18S, ITS) en el futuro, creando nuevas pestañas en el informe.
</td>
</tr>
</tbody>
</table>
</div>
<div style="height: 5px; background-color: transparent;">

</div>
<p>
A continuación se presentan los flujos de trabajo de las dos herramientas principales utilizadas en este análisis de metagenómica: <strong>miARma‑Seq</strong> para control de calidad y <strong>QIIME2</strong> para el análisis de datos de 16S. Cada diagrama ilustra la modularidad y reproducibilidad del pipeline.
</p>
<div style="height: 13px; background-color: transparent;">

</div>
<div class="titulo4">
<p>➤ Flujo de trabajo con miARma-Seq</p>
</div>
<p>
<strong>miARma‑Seq</strong> es un pipeline integral diseñado para análisis de RNA‑Seq (mRNA, miRNA y circRNA), desarrollado por <em>Eduardo Andrés‑León et al.</em>. Incluye múltiples módulos que permiten procesar datos crudos de manera modular y reproducible:
</p>
<ol>
<li>
<strong>Control de calidad inicial:</strong> Evaluación de archivos <code>FASTQ</code> mediante <em>FastQC</em>, con generación de reportes individuales y resúmenes globales usando <em>MultiQC</em>, permitiendo detectar adaptadores, sesgos de composición y problemas de calidad por posición.
</li>
<li>
<strong>Recorte de lecturas:</strong> Eliminación de adaptadores y bases de baja calidad mediante <em>Cutadapt</em> o <em>Reaper</em>, optimizando los datos antes de alineamiento.
</li>
<li>
<strong>Alineamiento:</strong> Mapeo contra genomas de referencia usando alineadores como <em>HISAT2</em>, <em>STAR</em>, <em>Bowtie</em> o <em>BWA</em>, dependiendo del tipo de RNA.
</li>
<li>
<strong>Cuantificación:</strong> Conteo de genes o isoformas con <em>featureCounts</em>, detección de circRNAs con <em>CIRI</em> y cuantificación de miRNAs con <em>miRDeep2</em>.
</li>
<li>
<strong>Análisis diferencial:</strong> Identificación de genes o miRNAs diferencialmente expresados mediante <em>edgeR</em> o <em>NOISeq</em>, según el diseño experimental.
</li>
<li>
<strong>Análisis funcional:</strong> Predicción de interacciones miRNA‑mRNA, correlaciones inversas de expresión y análisis de enriquecimiento funcional (GO, KEGG).
</li>
</ol>
<p>
Aunque miARma‑Seq ofrece todas estas funcionalidades, en este informe únicamente se ha utilizado el <strong>módulo de control de calidad</strong> para los archivos <code>FASTQ</code> de nuestro análisis metagenómico. Esto garantiza que las lecturas crudas de 16S sean de alta calidad antes de ser procesadas con QIIME2. Toda la documentación y el repositorio de miARma‑Seq están disponibles en su repoditorio de <a href="https://github.com/eandresleon/miARma-seq" class="normalink" target="_blank">GitHub</a>. Podemos ver el workflow completo de esta herramienta a continuación:
</p>
<div class="box-images">
<p><img src="resources/1-essential/1-images/tab0-inicio/miARma-Seq-workflow.png" alt="Pipeline completo de miARma-Seq"></p>
</div>
<p>
Para garantizar la <strong>reproducibilidad</strong> y <strong>modularidad</strong> del pipeline, <code>miARma‑Seq</code> utiliza un archivo de configuración con extensión <code>.ini</code>. Este archivo permite especificar todos los parámetros necesarios para ejecutar el pipeline completo de RNA-Seq, sin necesidad de escribir comandos complejos en la línea de comandos. En el contexto de este informe de metagenómica, se ha utilizado únicamente el módulo de control de calidad de lecturas (<code>FASTQ</code>), aunque el archivo <code>.ini</code> podría activar otros pasos del pipeline si se deseara.
</p>
<p>
El archivo <code>.ini</code> se organiza en secciones bien definidas (por ejemplo, <code>[General]</code>, <code>[QC]</code>, <code>[Aligner]</code>, <code>[ReadCount]</code>…), cada una dedicada a un módulo específico del pipeline de miARma‑Seq. En cada sección se indican rutas de entrada y salida, tipo de datos, número de hilos, herramientas a utilizar y criterios estadísticos.
</p>
<p>
A continuación se muestra un ejemplo real de un archivo <code>.ini</code> de miARma‑Seq, incluyendo los módulos de control de calidad, alineamiento, cuantificación y análisis diferencial para datos de RNA. En este informe, solo se ejecuta el módulo de <strong>QC</strong>:
</p>
<iframe src="resources/1-essential/2-archives/tab0-inicio/miARma_mRNAs_pipeline_STAR.txt" width="100%" height="500px" frameborder="0" style="border: none; display: block;">
</iframe>
<p style="text-align:center;">
<a href="resources/1-essential/2-archives/tab0-inicio/miARma_mRNAs_pipeline_STAR.txt" target="_blank" class="boton-iframe"> 🔍 Ver archivo completo en una nueva página </a>
</p>
<p>
Este archivo se ejecuta mediante el siguiente comando, una vez realizada la instalación y configuración de <code>miARma‑Seq</code>:
</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./miARma</span> miarma_config_example.ini check</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>
Para más información sobre esta herramienta y su pipeline completo, se puede consultar el repositorio oficial en <a href="https://github.com/eandresleon/miARma-seq" class="normalink" target="_blank">GitHub: miARma‑Seq</a>.<br>
En futuras extensiones del análisis metagenómico, se podría aprovechar más módulos del pipeline si se integran otros tipos de datos o se desea automatizar pasos adicionales.
</p>
<div style="height: 13px; background-color: transparent;">

</div>
<div class="titulo4">
<p>➤ Flujo de trabajo con QIIME2</p>
</div>
<p>
<strong>QIIME2</strong> es una plataforma especializada para análisis de metagenómica de amplicones, especialmente del marcador 16S, con un enfoque modular, reproducible y documentado. Su flujo de trabajo incluye múltiples etapas que permiten procesar, filtrar y analizar las secuencias de manera rigurosa, integrando herramientas estadísticas y visualización avanzada.
</p>
<ol>
<li>
<strong>Secuencias crudas (.fastq)</strong>: Se importan los archivos de secuenciación sin procesar, que contienen todas las lecturas de ADN de las muestras.
</li>
<li>
<strong>Validación del archivo de metadatos</strong>: Se comprueba que la información de cada muestra (por ejemplo, grupos experimentales) esté correctamente formateada y consistente con los datos de secuenciación.
</li>
<li>
<strong>Importación de secuencias</strong>: Conversión de los archivos <code>.fastq</code> al formato nativo de QIIME2, que permite la ejecución de los siguientes pasos del pipeline.
</li>
<li>
<strong>Demultiplexing</strong>: Separación de lecturas por muestra utilizando los índices o códigos de barras, asignando cada secuencia a su muestra de origen.
</li>
<li>
<strong>Filtrado de calidad, eliminación de quimeras y desreplicación</strong>: Se eliminan secuencias de baja calidad y quiméricas (artefactos de PCR), y se generan secuencias únicas (ASVs, Amplicon Sequence Variants) que representan las variantes biológicas reales.
</li>
<li>
<strong>Asignación taxonómica</strong>: Cada ASV se clasifica en niveles taxonómicos (especie, género, familia, etc.) usando bases de referencia.
</li>
<li>
<strong>Entrenamiento de la base de datos</strong>: Se entrena un clasificador de aprendizaje automático con bases de referencia (como SILVA o Greengenes) para mejorar la precisión de la asignación taxonómica.
</li>
<li>
<strong>Visualización de la taxonomía</strong>: Se generan gráficos que muestran la composición microbiana de cada muestra y del conjunto de datos.
</li>
<li>
<strong>Creación de árbol filogenético</strong>: Se construye un árbol filogenético que representa las relaciones evolutivas entre los ASVs, esencial para análisis de diversidad basados en distancia filogenética.
</li>
<li>
<strong>Análisis de diversidad alfa y beta</strong>: Cálculo de métricas de diversidad alfa (dentro de cada muestra) y beta (entre muestras) para comparar la riqueza, uniformidad y composición de las comunidades microbianas.
</li>
<li>
<strong>Exportación de resultados</strong>: Las tablas de ASVs, la asignación taxonómica y las métricas de diversidad se exportan a formatos compatibles con R u otros programas, facilitando análisis estadísticos, visualizaciones avanzadas y predicciones funcionales.
</li>
</ol>
<p>
Mediante la siguiente imagen podemos observar de forma más visual el workflow completo descrito anteriormente y seguido con esta herramienta:
</p>
<div class="box-images">
<p><img src="resources/1-essential/1-images/tab0-inicio/qiime2-workflow.png" alt="Pipeline de QIIME2"></p>
</div>
<p>
El uso combinado de <strong>QIIME2</strong> y <strong>R</strong> permite un análisis completo y reproducible de los datos de 16S, integrando diversidad, funcionalidad y estadística avanzada. La documentación oficial de QIIME2 está disponible en <a href="https://qiime2.org/" target="_blank" class="normalink">https://qiime2.org/</a>.
</p>
<p>
En conjunto, ambos pipelines —miARma‑Seq para control de calidad y QIIME2 para análisis metagenómico— se integran mediante <strong>Nextflow</strong> para generar un informe reproducible en <strong>Quarto</strong>. Esto asegura trazabilidad, modularidad y claridad en la interpretación de los resultados.
</p>
<div style="height: 13px; background-color: transparent;">

</div>
<div class="titulo4">
<p>➤ Reflexiones finales</p>
</div>
<p>
Con los datos procesados mediante <strong>miARma‑Seq</strong> para control de calidad y <strong>QIIME2</strong> para el análisis metagenómico, se ha generado el correspondiente informe automatizado de metagenómica mediante un pipeline reproducible desarrollado en <strong>Nextflow</strong>.
</p>
<p>
Este informe se organiza en tres pestañas principales para facilitar la navegación y la interpretación de resultados:
</p>
<ol>
<li>
<strong>Inicio</strong>: Esta pestaña, donde se describe el contexto, las herramientas empleadas, los pipelines y la filosofía de reproducibilidad del análisis.
</li>
<li>
<strong>Resumen</strong>: Contiene las métricas principales de calidad y análisis, la fecha de creación del documento y un resumen de los resultados más relevantes.
</li>
<li>
<strong>Análisis</strong>: Aquí se presenta todo el proceso de metagenómica, incluyendo gráficos, tablas de abundancia, métricas de diversidad y análisis estadísticos.<br>
En realidad, esta sección está dividida en tres pestañas específicas: <strong>Análisis 16S</strong>, <strong>Análisis 18S</strong> y <strong>Análisis ITS</strong>, pero en el presente informe nos centraremos principalmente en el análisis de 16S.
</li>
</ol>
<p>
El usuario puede navegar entre estas pestañas de manera interactiva mediante la barra de menú superior del informe, accediendo a la información general, los resúmenes principales y los análisis detallados de cada marcador según convenga.
</p>
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  CARGAR JAVASCRIPT PARA CHATBOT
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!-- Script exclusivo del chat -->
<script type="module" src="resources/1-essential/3-scripts/4-javascript/chatbot.js"></script>




<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>