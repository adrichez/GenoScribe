---
title: "RNA-Seq Report"

include-in-header:
  text: |
    <link rel="shortcut icon" href="../../../1-images/0-icono/favicon.svg"/>
    <link rel="icon" type="image/x-icon" href="../../../1-images/0-icono/favicon.ico">

params:
  ruta_proyecto: ""
  nombre_experimento: ""
---


<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  TAB 3: ANLISIS | 5. ANLISIS ESTADSTICO DE LA EXPRESIN GENTICA -->
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

```{r}
library(stringr)
library(glue)
library(fs)
library(dplyr)

# Definir rutas clave
ruta_qmd <- getwd()

ruta_rnaseq_pipeline <- sub("(.*?/1-bulk-rna-seq).*", "\\1", ruta_qmd)

nombre_proyecto <- basename(params$ruta_proyecto)

ruta_nextflow_results <- file.path("..", "..", "..", "..", "..", "resources", "2-nextflow-results")
ruta_proyecto_relativa <- file.path("..", "..", "..", "..", "..", "resources", "2-nextflow-results", "1-project-data", nombre_proyecto)


# Ruta donde est谩n los resultados de DEG y volcano
ruta_resultados_experimento <- file.path(params$ruta_proyecto, "Resultados", params$nombre_experimento)
ruta_resultados_experimento_relativa <- file.path(params$ruta_proyecto_relativa, "Resultados", params$nombre_experimento)


# Buscar archivos .xlsx y .pdf
archivos_deg <- list.files(ruta_resultados_experimento, pattern = "^DEG_.*\\.xlsx$", full.names = TRUE)
archivos_volcano <- list.files(ruta_resultados_experimento, pattern = "^Volcano_plot_.*\\.pdf$", full.names = TRUE)


# Extraer nombres base de comparaci贸n
comparaciones <- gsub("^DEG_(.*)\\.xlsx$", "\\1", basename(archivos_deg))
comparaciones <- gsub("_", " ", comparaciones)


# Ruta donde est谩n los resultados de enriquecimiento
ruta_enrichment <- file.path(params$ruta_proyecto, "Resultados", params$nombre_experimento, "Enrichment")
ruta_enrichment_relativa <- file.path(ruta_proyecto_relativa, "Resultados", params$nombre_experimento, "Enrichment")


# Archivos
archivos_enrichment <- list.files(ruta_enrichment, pattern = "^Enrichment_.*\\.(pdf|xls)$", full.names = TRUE)
archivos_enrichment_relativa <- list.files(ruta_enrichment_relativa, pattern = "^Enrichment_.*\\.(pdf|xls)$", full.names = TRUE)


# Extraer categor铆a funcional y comparaci贸n
info_archivos <- str_match(
  basename(archivos_enrichment_relativa),
  "^Enrichment_((?:GO_(?:BP|CC|MF)|KEGG))_([^_]+_vs_[^_]+)_"
)


# Crear un data.frame con columnas 煤tiles
df_info <- data.frame(
  ruta_archivo = archivos_enrichment_relativa,
  categoria_funcional = info_archivos[,2],
  comparacion = info_archivos[,3],
  tipo = tools::file_ext(archivos_enrichment_relativa),
  stringsAsFactors = FALSE
)


# Reemplazar "_" por ":" en la columna 'categoria_funcional'
df_info$categoria_funcional <- str_replace_all(df_info$categoria_funcional, "_", ":")


# Reemplazar "_" por " " en la columna 'comparacion'
df_info$comparacion <- str_replace_all(df_info$comparacion, "_", " ")
```


<div class="informe-titulo-tab">
  <h1>Pesta帽a</h1>
  <h2>An谩lisis bioinform谩tico completo</h2>
</div>

<div class="informe-titulo-seccion">
  <h1>Secci贸n 5</h1>
  <h2>An谩lisis estad铆stico de la expresi贸n g茅nica</h2>
</div>

<div class="informe-resumen">
  <h2>Resumen</h2>

  <p>
    Esta secci贸n representa el n煤cleo del an谩lisis transcript贸mico, centrado en el <strong>tratamiento estad铆stico de los datos de expresi贸n g茅nica</strong> para garantizar su <em>fiabilidad</em>, <em>calidad</em> y <em>valor biol贸gico interpretativo</em>. Abarca desde la <strong>normalizaci贸n</strong> de los recuentos de expresi贸n hasta la <strong>identificaci贸n de genes diferencialmente expresados</strong> y su posterior <strong>interpretaci贸n funcional</strong>. Cada uno de estos pasos se implementa de manera secuencial y justificada, asegurando que los resultados finales est茅n basados en datos rigurosamente procesados y validados.
  </p>

  <p>
    Dado el alto volumen de informaci贸n, visualizaciones interactivas y tablas que forman parte de este bloque, se ha optado por una <em>estructura modular</em> en la que cada subsecci贸n est谩 incrustada mediante un <code>&lt;iframe&gt;</code> y acompa帽ada de un bot贸n de acceso directo. Esto permite una <strong>carga eficiente y segmentada</strong> del contenido, mejorando la navegaci贸n y evitando bloqueos de rendimiento que podr铆an afectar la experiencia del usuario.
  </p>

  <p>
    En la primera parte del an谩lisis, se aplica un proceso de <strong>normalizaci贸n de la expresi贸n g茅nica</strong>, crucial para eliminar sesgos t茅cnicos derivados del tama帽o de las bibliotecas o de la longitud de los genes. Se emplean medidas como <strong>RPKM</strong> para homogeneizar los datos y se realiza una <em>evaluaci贸n visual y cuantitativa</em> de la transformaci贸n, asegurando su efectividad antes de avanzar.
  </p>

  <p>
    Posteriormente, se lleva a cabo una <strong>evaluaci贸n del control de calidad</strong> sobre los datos normalizados, mediante <em>an谩lisis exploratorios</em> como PCA, clustering jer谩rquico o heatmaps, que permiten verificar la <em>coherencia interna del dataset</em> y detectar posibles muestras at铆picas que puedan comprometer la interpretaci贸n de los resultados.
  </p>

  <p>
    Una vez asegurada la calidad de los datos, se procede con el <strong>an谩lisis de expresi贸n diferencial</strong>, en el que se comparan pares de condiciones experimentales para identificar <strong>genes regulados diferencialmente</strong>. Este paso proporciona listas detalladas de genes con m茅tricas estad铆sticas relevantes y m煤ltiples representaciones visuales que facilitan su interpretaci贸n y priorizaci贸n.
  </p>

  <p>
    Finalmente, se integran estos resultados en un <strong>an谩lisis funcional y de enriquecimiento</strong>, donde se examina la <em>sobrerrepresentaci贸n de funciones biol贸gicas</em> (mediante ontolog铆as GO y rutas KEGG) entre los genes diferencialmente expresados. Esta etapa permite conectar los cambios de expresi贸n observados con <strong>procesos celulares o moleculares relevantes</strong>, dando sentido biol贸gico al conjunto del estudio.
  </p>

  <p>
    En conjunto, esta secci贸n consolida todo el trabajo realizado previamente en el pipeline, transformando datos de secuenciaci贸n masiva en <strong>hallazgos estad铆stica y biol贸gicamente s贸lidos</strong>. Constituye as铆 un paso esencial para la <em>generaci贸n de hip贸tesis funcionales</em> y la <strong>exploraci贸n de mecanismos moleculares</strong> implicados en las condiciones experimentales analizadas.
  </p>
</div>









<div style="height: 15px; background-color: transparent;"></div>

<div class="titulo-toc">
  Tabla de contenidos de esta secci贸n
</div>

```{=html}
```{r, results="asis"}
cat('
<div class="toc">
  <ul>
    <li>
      <a href="#tab3-seccion5">
        5<span>.</span> An谩lisis estad铆stico de la expresi贸n g茅nica
      </a>
      <ul>
        <li>
          <a href="5.1-normalizacion.html#tab3-seccion5.1">
            5.1. Normalizaci贸n de los datos de expresi贸n
          </a>
          <ul>
            <li>
              <a href="5.1-normalizacion.html#tab3-seccion5.1.1">
                5.1.1. Visualizaci贸n de la matriz normalizada
              </a>
            </li>
            <li>
              <a href="5.1-normalizacion.html#tab3-seccion5.1.2">
                5.1.2. Total de expresi贸n por muestra (RPKM)
              </a>
            </li>
            <li>
              <a href="5.1-normalizacion.html#tab3-seccion5.1.3">
                5.1.3. N煤mero de genes expresados por muestra (RPKM)
              </a>
            </li>
            <li>
              <a href="5.1-normalizacion.html#tab3-seccion5.1.4">
                5.1.4. Genes con mayor expresi贸n total (RPKM)
              </a>
            </li>
            <li>
            <a href="5.1-normalizacion.html#tab3-seccion5.1.5">
              5.1.5. Distribuci贸n de expresi贸n por muestra (boxplot log10 RPKM)
            </a>
            </li>
            <li>
              <a href="5.1-normalizacion.html#tab3-seccion5.1.6">
                5.1.6. Comparaci贸n entre recuentos crudos y datos normalizados
              </a>
            </li>
          </ul>
        </li>
        <li>
          <a href="5.2-evaluacion-calidad-normalizacion.html#tab3-seccion5.2">
            5.2. Evaluaci贸n del control de calidad tras la normalizaci贸n
          </a>
        </li>
        <li>
          <a href="5.3-analisis-expresion.html#tab3-seccion5.3">
            5.3. An谩lisis de expresi贸n diferencial
          </a>
          <ul>
')

# Subapartados generados autom谩ticamente
for (i in seq_along(comparaciones)) {
  cat(glue::glue('
            <li>
              <a href="5.3-analisis-expresion.html#tab3-seccion5.3.{i}">
                5.3.{i}. Comparaci贸n: {comparaciones[i]}
              </a>
            </li>
\n'))
}

cat('
          </ul>
        </li>
        <li>
          <a href="5.4-analisis-funcional.html#tab3-seccion5.4">
            5.4. An谩lisis funcional y enriquecimiento
          </a>
          <ul>
')

comparaciones <- unique(df_info$comparacion)
for (i in seq_along(comparaciones)) {
  comp <- comparaciones[i]
  cat(glue::glue('
            <li>
              <a href="5.4-analisis-funcional.html#tab3-seccion-5.4.{i}">
                5.4.{i}. Comparaci贸n: {comp}
              </a>
              <ul>
  '))

  subset_comp <- df_info[df_info$comparacion == comp, ]
  categorias <- unique(subset_comp$categoria_funcional)

  for (j in seq_along(categorias)) {
    categ <- categorias[j]
    cat(glue::glue('
                <li>
                  <a href="5.4-analisis-funcional.html#tab3-seccion-5.4.{i}.{j}">
                    5.4.{i}.{j}. Categor铆a funcional: {categ}
                  </a>
                </li>
    '))
  }

  cat('
              </ul>
            </li>
  ')
}

cat('
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</div>
')
```
```

```{=html}
```











<!-- #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<!-- REDACCIN -->
<!-- #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->

<div style="height: 25px; background-color: transparent;"></div>

<div class="titulo1" id="tab3-seccion5">
  5<span>.</span> An谩lisis estad铆stico de la expresi贸n g茅nica
</div>

<p>
  Tras la generaci贸n de la <em>matriz de expresi贸n g茅nica</em>, el an谩lisis se centra ahora en extraer conocimiento biol贸gicamente relevante a partir de los datos cuantitativos obtenidos. 
  Para ello, esta secci贸n se enfoca en el <strong>tratamiento estad铆stico de la expresi贸n g茅nica</strong>, con el prop贸sito de detectar patrones diferenciales que reflejen 
  <strong>alteraciones en la regulaci贸n transcripcional</strong> entre las condiciones o grupos estudiados.
</p>

<p>
  En primer lugar, se aplica un proceso de <strong>normalizaci贸n</strong> para corregir <em>sesgos t茅cnicos</em> derivados, por ejemplo, de diferencias en la <em>profundidad de secuenciaci贸n</em> o en la <em>longitud de los genes</em>. 
  A continuaci贸n, se examina la <strong>estructura global del conjunto de muestras</strong> mediante t茅cnicas exploratorias que permiten evaluar su homogeneidad y la posible presencia de agrupamientos naturales.
  Posteriormente, se procede a la <strong>identificaci贸n de genes diferencialmente expresados (DEGs)</strong> mediante m茅todos de <em>inferencia estad铆stica</em> adaptados a la naturaleza de los datos RNA-Seq.
  Finalmente, se presentan visualizaciones espec铆ficas y se introduce el an谩lisis <strong>funcional y de enriquecimiento</strong>, que permitir谩 interpretar los resultados en un contexto biol贸gico m谩s amplio.
</p>









<div style="height: 20px; background-color: transparent;"></div>

<div class="titulo2" id="tab3-seccion5.1">
  5.1. Normalizaci贸n de los datos de expresi贸n
</div>

<p>
  En este apartado se lleva a cabo la <strong>normalizaci贸n de los datos de expresi贸n g茅nica</strong>, un paso esencial para garantizar la <em>comparabilidad entre muestras</em> y minimizar sesgos t茅cnicos derivados del <em>tama帽o de las bibliotecas de secuenciaci贸n</em> o de la <em>longitud de los genes</em>. Se transforma la matriz de recuentos crudos en medidas normalizadas, como <strong>RPKM (Reads Per Kilobase per Million)</strong>, que permiten interpretar los niveles de expresi贸n de forma m谩s robusta y comparable entre genes y muestras.
</p>

<p>
  A lo largo del an谩lisis, se <strong>visualiza la matriz normalizada</strong> y se eval煤an m茅tricas clave como el <em>total de expresi贸n por muestra</em> o el <em>n煤mero de genes expresados</em>, permitiendo detectar posibles <strong>anomal铆as o desviaciones</strong> tras la transformaci贸n. Tambi茅n se identifican los genes con mayor expresi贸n global y se estudia la <em>distribuci贸n de expresi贸n</em> a trav茅s de diagramas de caja, compar谩ndola con los datos originales para valorar el efecto de la normalizaci贸n.
</p>

<p>
  Esta fase prepara el terreno para los an谩lisis posteriores, donde se requerir谩 que los datos est茅n correctamente ajustados para aplicar <strong>modelos estad铆sticos fiables</strong>. La normalizaci贸n, por tanto, constituye un paso fundamental previo a la <em>evaluaci贸n de la calidad post-normalizaci贸n</em> y a los an谩lisis de <strong>expresi贸n diferencial</strong> y <strong>enriquecimiento funcional</strong>, claves para extraer conocimiento biol贸gico relevante a partir del perfil transcript贸mico estudiado.
</p>

<iframe src="5.1-normalizacion.html#tab3-seccion5.1" width="100%" height="600px" style="border: 1px solid #ccc; border-radius: 6px;"></iframe>

<p style="text-align:center;">
  <a href="5.1-normalizacion.html#tab3-seccion5.1" class="boton-subseccion">
     Ir a la secci贸n: 5.1. Normalizaci贸n de los datos de expresi贸n
  </a>
</p>








<div style="height: 20px; background-color: transparent;"></div>

<div class="titulo2" id="tab3-seccion5.1">
  5.2. Evaluaci贸n del control de calidad tras la normalizaci贸n
</div>

<p>
  En este apartado se realiza una <strong>evaluaci贸n exhaustiva del control de calidad</strong> tras la normalizaci贸n de los datos de expresi贸n g茅nica. Este paso es crucial para comprobar que la normalizaci贸n ha corregido adecuadamente las <em>variaciones t茅cnicas</em> inherentes al proceso experimental, sin afectar la <em>estructura biol贸gica real</em> de las muestras analizadas.
</p>

<p>
  Para ello, se aplican diversas t茅cnicas exploratorias y visualizaciones estad铆sticas que permiten evaluar la homogeneidad y coherencia de los datos normalizados. Entre estas t茅cnicas se incluyen el <strong>An谩lisis de Componentes Principales (PCA)</strong>, que facilita la identificaci贸n de agrupamientos y posibles outliers; el c谩lculo de la <strong>matriz de correlaci贸n</strong> entre muestras, que cuantifica similitudes globales; y el <strong>clustering jer谩rquico</strong>, que organiza las muestras seg煤n patrones de expresi贸n comunes.
</p>

<p>
  Asimismo, se generan <strong>mapas de calor (heatmaps)</strong> y gr谩ficos de distribuci贸n como <em>boxplots</em> y <em>density plots</em> que ofrecen una visi贸n integral sobre la variabilidad y consistencia de la expresi贸n g茅nica tras el ajuste. Estas herramientas facilitan la detecci贸n de posibles muestras problem谩ticas o artefactos remanentes que podr铆an afectar la interpretaci贸n biol贸gica.
</p>

<p>
  Todos estos an谩lisis y visualizaciones se compilan en un <strong>informe consolidado en formato PDF</strong>, disponible para consulta y descarga en la ruta especificada, sirviendo como una gu铆a valiosa para validar la calidad del dataset y asegurar la fiabilidad de los an谩lisis posteriores de expresi贸n diferencial y enriquecimiento funcional.
</p>

<iframe src="5.2-evaluacion-calidad-normalizacion.html#tab3-seccion5.2" width="100%" height="600px" style="border: 1px solid #ccc; border-radius: 6px;"></iframe>

<p style="text-align:center;">
  <a href="5.2-evaluacion-calidad-normalizacion.html#tab3-seccion5.2" class="boton-subseccion">
     Ir a la secci贸n: 5.2. Evaluaci贸n del control de calidad tras la normalizaci贸n
  </a>
</p>








<div style="height: 20px; background-color: transparent;"></div>

<div class="titulo2" id="tab3-seccion5.3">
  5.3. An谩lisis de expresi贸n diferencial
</div>

<p>
  En este apartado se lleva a cabo el <strong>an谩lisis de expresi贸n diferencial</strong>, una etapa central en los estudios transcript贸micos que tiene como objetivo 
  identificar <em>genes cuya expresi贸n var铆a significativamente</em> entre distintas <strong>condiciones experimentales</strong>. A partir de los datos previamente 
  <em>normalizados</em> y validados en t茅rminos de calidad, se establecen comparaciones por pares entre grupos definidos en el dise帽o experimental.
</p>

<p>
  Para cada una de estas comparaciones, se calcula el <strong>cambio de expresi贸n</strong> de cada gen y su <em>significancia estad铆stica</em>, lo que permite detectar 
  genes <strong>activados o reprimidos</strong> en respuesta a una determinada condici贸n. Los resultados se resumen en <code>archivos .xlsx</code> que incluyen m茅tricas clave 
  como el <em>log2 fold-change (logFC)</em>, el <em>nivel medio de expresi贸n (logCPM)</em>, el <em>valor p</em> y su correcci贸n por <strong>FDR</strong> (tasa de falsos descubrimientos). 
  Cada gen es clasificado como <strong>Diferencialmente Expresado (DEG)</strong> o no, en funci贸n de estos criterios.
</p>

<p>
  Adicionalmente, se generan <strong>gr谩ficos volcano</strong> que proporcionan una representaci贸n visual clara de los resultados, permitiendo identificar de forma r谩pida 
  los genes m谩s relevantes por su magnitud de cambio y significancia. Estos gr谩ficos son complementados con <strong>otras visualizaciones interactivas</strong> como histogramas, 
  MA plots, an谩lisis de proporciones DEG/no-DEG y listados de genes m谩s significativos, lo que facilita una <em>exploraci贸n visual y comparativa</em> de cada contraste realizado.
</p>

<p>
  Este an谩lisis diferencial constituye un <strong>punto de partida fundamental</strong> para estudios posteriores de interpretaci贸n biol贸gica, ya que los genes identificados como 
  DEG pueden estar implicados en procesos funcionales relevantes, ser biomarcadores potenciales o servir como hip贸tesis para nuevas investigaciones. En las siguientes secciones 
  se abordar谩 precisamente esta interpretaci贸n mediante <em>an谩lisis funcionales y de enriquecimiento</em>.
</p>

<iframe src="5.3-analisis-expresion.html#tab3-seccion5.2." width="100%" height="600px" style="border: 1px solid #ccc; border-radius: 6px;"></iframe>

<p style="text-align:center;">
  <a href="5.3-analisis-expresion.html#tab3-seccion5.2" class="boton-subseccion">
     Ir a la secci贸n: 5.3. An谩lisis de expresi贸n diferencial
  </a>
</p>








<div style="height: 20px; background-color: transparent;"></div>

<div class="titulo2" id="tab3-seccion5.3">
  5.4. An谩lisis funcional y enriquecimiento
</div>

<p>
  Este apartado tiene como objetivo interpretar los resultados del an谩lisis de expresi贸n diferencial desde una perspectiva <strong>biol贸gica funcional</strong>, utilizando herramientas de <strong>an谩lisis de enriquecimiento</strong>. Una vez identificados los <strong>genes diferencialmente expresados (DEGs)</strong> entre condiciones experimentales, se eval煤a si determinadas <em>funciones biol贸gicas</em>, <em>procesos celulares</em> o <em>rutas metab贸licas</em> est谩n sobrerrepresentadas entre estos genes.
</p>

<p>
  Para ello, se emplean bases de datos ampliamente reconocidas como <strong>Gene Ontology</strong> (categor铆as <em>Biological Process</em>, <em>Molecular Function</em> y <em>Cellular Component</em>) y <strong>KEGG</strong>, que permiten relacionar los genes con funciones conocidas en organismos modelo. El an谩lisis se realiza de forma individual para cada <em>comparaci贸n por pares</em> entre condiciones, lo que permite contextualizar los efectos de cada contraste experimental dentro de marcos funcionales espec铆ficos.
</p>

<p>
  Cada conjunto de resultados incluye una tabla interactiva con los <strong>t茅rminos enriquecidos</strong> y sus estad铆sticas asociadas (como valores <em>p</em> ajustados y n煤mero de genes implicados), as铆 como <strong>representaciones gr谩ficas</strong> (barplots o dotplots) que resumen visualmente los hallazgos m谩s relevantes. Esta informaci贸n facilita la priorizaci贸n de rutas y procesos que podr铆an estar involucrados en las diferencias observadas, ofreciendo hip贸tesis biol贸gicas interpretables.
</p>

<p>
  En conjunto, este an谩lisis constituye una pieza clave para vincular los cambios transcripcionales con mecanismos funcionales subyacentes, aportando <strong>valor biol贸gico</strong> y <strong>contexto mecan铆stico</strong> a los datos obtenidos en las etapas anteriores del pipeline de expresi贸n g茅nica.
</p>

<iframe src="5.4-analisis-funcional.html#tab3-seccion5.2." width="100%" height="600px" style="border: 1px solid #ccc; border-radius: 6px;"></iframe>

<p style="text-align:center;">
  <a href="5.3-analisis-expresion.html#tab3-seccion5.2" class="boton-subseccion">
     Ir a la secci贸n: 5.4. An谩lisis funcional y enriquecimiento
  </a>
</p>

<div style="height: 5px; background-color: transparent;"></div>

---

<p>
  Con este an谩lisis funcional y de enriquecimiento se culmina el flujo de trabajo completo de an谩lisis de expresi贸n g茅nica, desde la evaluaci贸n inicial de la calidad de las lecturas hasta la interpretaci贸n biol贸gica de los genes diferencialmente expresados. 
  A lo largo de este proceso, hemos transformado datos brutos de secuenciaci贸n en informaci贸n biol贸gicamente significativa, permitiendo no solo identificar genes con patrones de expresi贸n relevantes, sino tambi茅n contextualizarlos dentro de rutas y procesos celulares clave. 
  Este enfoque sistem谩tico no solo proporciona una comprensi贸n m谩s profunda de los mecanismos moleculares implicados en las condiciones estudiadas, sino que tambi茅n sienta las bases para futuras hip贸tesis experimentales, validaciones funcionales o estrategias terap茅uticas.
</p>