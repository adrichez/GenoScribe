---
title: "RNA-Seq Report"

include-in-header:
  text: |
    <link rel="shortcut icon" href="../../../1-images/0-icono/favicon.svg"/>
    <link rel="icon" type="image/x-icon" href="../../../1-images/0-icono/favicon.ico">

params:
  ruta_proyecto: ""
  nombre_experimento: ""
---


<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  TAB 3: ANLISIS | 2. EVALUACIN DE LA CALIDAD DE LAS LECTURAS -->
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

```{r}
library(glue)
library(fs)
library(stringr)
library(dplyr)

# Definir rutas clave
ruta_qmd <- getwd()

ruta_rnaseq_pipeline <- sub("(.*?/1-bulk-rna-seq).*", "\\1", ruta_qmd)

nombre_proyecto <- basename(params$ruta_proyecto)

ruta_nextflow_results <- file.path("..", "..", "..", "..", "..", "resources", "2-nextflow-results")
ruta_proyecto_relativa <- file.path("..", "..", "..", "..", "..", "resources", "2-nextflow-results", "1-project-data", nombre_proyecto)


targets_experimento <- paste0("targets_", params$nombre_experimento, ".txt")

ruta_targets_experimento <- file.path(params$ruta_proyecto, "Resultados", targets_experimento)
file_ruta_targets_experimento <- gsub(" ", "%20", paste0("file:///", ruta_targets_experimento))

ruta_targets_experimento_relativa <- file.path(ruta_proyecto_relativa, "Resultados", targets_experimento)



reads_down_select_experimento <- paste0("reads_down_select_", params$nombre_experimento)

ruta_reads_down_select_experimento <- file.path(params$ruta_proyecto, "Analisis", reads_down_select_experimento)

ruta_reads_down_select_experimento_relativa <- file.path(ruta_proyecto_relativa, "Analisis", reads_down_select_experimento)


ruta_Pre_fastqc_results <- file.path(params$ruta_proyecto, "Analisis", params$nombre_experimento, "Pre_fastqc_results")

ruta_Pre_fastqc_results_relativa <- file.path(ruta_proyecto_relativa, "Analisis", params$nombre_experimento, "Pre_fastqc_results")


# Obtener archivos .html de FastQC
archivos_html <- dir_ls(ruta_Pre_fastqc_results, regexp = "\\.html$")

# Extraer IDs de muestra
ids_muestras <- archivos_html |>
  path_file() |>
  str_replace("_fastqc\\.html$", "") |>
  str_remove("_(R1|R2)$") |>
  unique()


# Leer targets
targets <- read.table(ruta_targets_experimento, header = TRUE, fill = TRUE, stringsAsFactors = FALSE)


# Listar archivos fastqc y fastq
archivos_fastqc <- list.files(ruta_Pre_fastqc_results, pattern = "_fastqc\\.html$", full.names = FALSE)
archivos_fastq <- list.files(ruta_reads_down_select_experimento, pattern = "\\.fastq\\.gz$", full.names = FALSE)


# Extraer identificadores base
ids_fastqc <- unique(gsub("(_R[12])?_fastqc\\.html$", "", archivos_fastqc))
ids_fastq <- unique(gsub("_R[12]\\.fastq\\.gz$", "", archivos_fastq))
ids_targets <- targets$Filename


# Identificar diferencias
fastqc_no_targets <- setdiff(ids_fastqc, ids_targets)
targets_no_fastqc <- setdiff(ids_targets, ids_fastqc)
targets_no_reads <- setdiff(ids_targets, ids_fastq)

# Ruta absoluta al archivo que quieres mostrar
ruta_multiqc_report <- file.path(ruta_nextflow_results, "2-fastqc-report/results-multiqc/multiqc_report.html")
```


<div class="informe-titulo-tab">
  <h1>Pesta帽a</h1>
  <h2>An谩lisis bioinform谩tico completo</h2>
</div>

<div class="informe-titulo-seccion">
  <h1>Secci贸n 2</h1>
  <h2>Evaluaci贸n de la calidad de las lecturas</h2>
</div>

<div class="informe-resumen">
  <h2>Resumen</h2>

  <p>
    En esta secci贸n se presentan los resultados del control de calidad aplicado a los archivos <code>.fastq.gz</code> generados tras la secuenciaci贸n. La evaluaci贸n se ha llevado a cabo tanto a nivel global como individual, utilizando las herramientas <strong>FastQC</strong> y <strong>MultiQC</strong>, integradas tanto en el pipeline de <strong>miARmaSeq</strong> como en el pipeline espec铆fico para este informe desarrollado con <strong>Nextflow</strong>.
  </p>

  <p>
    En primer lugar, se incluye un informe consolidado generado por <strong>MultiQC</strong>, que resume de forma interactiva los principales par谩metros de calidad de todas las muestras procesadas. Este informe permite identificar patrones generales, anomal铆as globales o diferencias sistem谩ticas entre condiciones experimentales.
  </p>

  <p>
    A continuaci贸n, se muestran los informes individuales de <strong>FastQC</strong> generados autom谩ticamente para cada muestra. Estos informes permiten una revisi贸n m谩s detallada por direcci贸n de lectura (<em>Forward</em> y <em>Backward</em>) e incluyen m茅tricas clave como la calidad por base, contenido GC, niveles de duplicaci贸n o detecci贸n de adaptadores. Cada informe se presenta embebido mediante un <code>iframe</code>, acompa帽ado de un bot贸n que permite visualizarlo en una pesta帽a independiente para facilitar su lectura.
  </p>

  <p>
    La estructura de esta secci贸n sigue un esquema jer谩rquico organizado por tipo de lectura y muestra, lo que permite una navegaci贸n m谩s clara y accesible. Adem谩s, dado que el informe ha sido dise帽ado para ser completamente <strong>automatizado y reproducible</strong>, los apartados correspondientes a cada muestra se generan din谩micamente a partir de los metadatos disponibles, adapt谩ndose as铆 a cualquier conjunto de datos experimental.
  </p>
</div>








<div style="height: 15px; background-color: transparent;"></div>

<div class="titulo-toc">
  Tabla de contenidos de esta secci贸n
</div>

```{=html}
```{r, results="asis"}
cat('
<div class="toc">
  <ul>
    <li>
      <a href="#tab3-seccion2">
        2<span>.</span> Evaluaci贸n de la calidad de las lecturas
      </a>
      <ul>
        <li>
          <a href="#tab3-seccion2.1">
            2.1. An谩lisis conjunto de todas las muestras (MultiQC)
          </a>
        </li>
        <li>
          <a href="#tab3-seccion2.2">
            2.2. An谩lisis individual por muestra (FastQC)
          </a>
          <ul>
            <li>
              <a href="#tab3-seccion2.2.1">
                2.2.1. Evaluaci贸n de calidad de lecturas Forward
              </a>
              <ul>
')

i <- 1
for (id in ids_muestras) {
  cat(glue::glue('<li><a href="#tab3-seccion2.2.1.{i}">2.2.1.{i}. Muestra: {id}</a></li>\n'))
  i <- i + 1
}

cat('
              </ul>
            </li>
            <li><a href="#tab3-seccion2.2.2">2.2.2. Evaluaci贸n de calidad de lecturas Backward</a>
              <ul>
')

i <- 1
for (id in ids_muestras) {
  cat(glue::glue('<li><a href="#tab3-seccion2.2.2.{i}">2.2.2.{i}. Muestra: {id}</a></li>\n'))
  i <- i + 1
}

cat('
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#tab3-seccion2.3">2.3. Reflexiones finales sobre el control de calidad</a>
      </ul>
    </li>
  </ul>
</div>
')
```
```

```{=html}
```










<!-- #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<!-- REDACCIN -->
<!-- #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->

<div style="height: 25px; background-color: transparent;"></div>

<div class="titulo1" id="tab3-seccion2">
  2<span>.</span> Evaluaci贸n de la calidad de las lecturas
</div>

<p>
  La calidad de las lecturas en un experimento de RNA-Seq es un factor determinante para la fiabilidad de los an谩lisis posteriores, como el alineamiento, la cuantificaci贸n y la identificaci贸n de genes diferencialmente expresados. Por ello, uno de los primeros pasos fundamentales en cualquier pipeline de procesamiento es la evaluaci贸n de la calidad de los archivos <code>.fastq.gz</code> generados tras la secuenciaci贸n.
</p>

<p>
  En este estudio, el control de calidad se aplic贸 a <strong>todas las muestras disponibles inicialmente</strong>, independientemente de si fueron seleccionadas o no para el an谩lisis principal. Este enfoque garantiza una evaluaci贸n exhaustiva del conjunto completo de datos, permitiendo detectar posibles problemas antes de la selecci贸n definitiva de las muestras a analizar.
</p>

<p>
  El control de calidad se llev贸 a cabo utilizando la herramienta <strong>FastQC</strong>, la cual genera informes detallados por muestra sobre diversos aspectos de la calidad de las secuencias. Posteriormente, todos estos informes individuales fueron integrados mediante <strong>MultiQC</strong>, generando un 煤nico informe resumen interactivo. Este informe consolidado permite inspeccionar de forma global y comparativa el estado de las lecturas en todas las muestras procesadas.
</p>

<p>
  Las m茅tricas clave incluidas en el informe de MultiQC son, entre otras:
</p>

<ul>
  <li>Calidad de las bases a lo largo de las lecturas (per base sequence quality).</li>
  <li>Contenido de GC.</li>
  <li>Presencia de adaptadores o contaminantes.</li>
  <li>Nivel de duplicaci贸n de las secuencias.</li>
  <li>Distribuci贸n de la longitud de las lecturas.</li>
</ul>

<p>
  Estas m茅tricas permiten identificar posibles problemas t茅cnicos, como degradaci贸n del ARN, contaminaci贸n por adaptadores, sesgos sistem谩ticos u otros artefactos de la secuenciaci贸n. Esta informaci贸n es esencial para tomar decisiones informadas sobre la necesidad de aplicar pasos de filtrado o recorte antes de proceder con el alineamiento.
</p>

<p>
  Es importante se帽alar que <strong>no todas las muestras presentes en el informe de MultiQC est谩n incluidas en el an谩lisis principal</strong>. La tabla de metadatos presentada anteriormente recoge 煤nicamente las muestras seleccionadas para las etapas posteriores de alineamiento y cuantificaci贸n, por lo que puede haber discrepancias entre ambas.
</p>








<div style="height: 20px; background-color: transparent;"></div>

<div class="titulo2" id="tab3-seccion2.1">
  2.1. An谩lisis conjunto de todas las muestras (MultiQC)
</div>

<p>
  El an谩lisis conjunto de calidad se ha llevado a cabo mediante la herramienta <strong>MultiQC</strong>, la cual agrega y resume de forma interactiva los informes individuales generados previamente por <strong>FastQC</strong> para cada una de las muestras procesadas. Este enfoque permite visualizar en un 煤nico informe consolidado todas las m茅tricas relevantes, facilitando la comparaci贸n entre muestras y la identificaci贸n de posibles anomal铆as sistem谩ticas, errores t茅cnicos o patrones comunes.
</p>

<p>
  El informe MultiQC incluye gr谩ficos y tablas que resumen aspectos clave como la calidad por base, el contenido GC, la longitud de las lecturas, la presencia de adaptadores o contaminantes y otros indicadores de calidad. Esta visi贸n global resulta especialmente 煤til para tomar decisiones sobre la limpieza y filtrado de las lecturas antes del alineamiento.
</p>

<p>
  A continuaci贸n, se muestra el informe interactivo integrado directamente en este documento. Tambi茅n se proporciona un bot贸n para abrirlo en una nueva pesta帽a, lo cual permite una visualizaci贸n m谩s c贸moda y detallada si se desea explorar el informe en mayor profundidad.
</p>

```{r, results='asis'}
cat(glue::glue('
<iframe src={ruta_multiqc_report} width="100%" height="700px" loading="lazy" style="border:none;"></iframe>

<p style="text-align:center;">
  <a href={ruta_multiqc_report} target="_blank" class="boton-iframe">
     Ver informe interactivo de MultiQC en una nueva p谩gina
  </a>
</p>

<div style="height: 15px; background-color: transparent;"></div>
\n\n'))
```

<p>
  En la siguiente secci贸n se detallar谩 el an谩lisis individual de la calidad de cada muestra, diferenciando entre lecturas <em>forward</em> y <em>backward</em>, mediante la incorporaci贸n directa de los informes <strong>FastQC</strong> individuales generados autom谩ticamente por <strong>miARmaSeq</strong>.
</p>








<div style="height: 20px; background-color: transparent;"></div>

<div class="titulo2" id="tab3-seccion2.2">
  2.2. An谩lisis individual por muestra (FastQC)
</div>

<p>
  Tras la evaluaci贸n conjunta mediante <strong>MultiQC</strong>, esta subsecci贸n se centra en el an谩lisis individualizado de cada una de las muestras a trav茅s de los informes generados por <strong>FastQC</strong>. Este enfoque permite inspeccionar con mayor nivel de detalle los distintos par谩metros de calidad, identificando posibles incidencias espec铆ficas que podr铆an no ser evidentes en el an谩lisis global.
</p>

<p>
  <strong>FastQC</strong> es una herramienta ampliamente utilizada para el control de calidad de datos de secuenciaci贸n masiva. Proporciona una evaluaci贸n visual e interactiva de aspectos fundamentales como la calidad por base a lo largo de las lecturas, el contenido de GC, la presencia de adaptadores, la sobre-representaci贸n de secuencias, la longitud de las lecturas o el nivel de duplicaci贸n. Esta informaci贸n resulta clave para valorar la idoneidad de los datos brutos antes de aplicar pasos de filtrado, recorte o alineamiento.
</p>

<p>
  En este informe, cada muestra dispone de una secci贸n dedicada organizada por tipo de lectura <em>(forward y backward)</em>, donde se presenta su correspondiente informe <code>.html</code> de FastQC. Los informes han sido generados autom谩ticamente por el pipeline <strong>miARmaSeq</strong> y se integran en este documento mediante una ventana interactiva para facilitar su visualizaci贸n directa, junto con un bot贸n de acceso para visualizarlo con m谩s detalle en pesta帽a nueva.
</p>

<p>
  Todos los informes individuales utilizados para generar el resumen de MultiQC se encontraban almacenados en el siguiente directorio en el momento de la generaci贸n de este informe:
</p>

```{r, results='asis'}
cat(glue::glue('
<code>{ruta_Pre_fastqc_results}</code>
\n\n'))
```

<p>
  A continuaci贸n, se muestra el listado completo de los archivos de salida generados por <code>FastQC</code> para cada una de las muestras procesadas. Para cada muestra se generan dos archivos principales: un informe en formato <code>.html</code>, que ofrece una visualizaci贸n interactiva de los resultados del control de calidad, y un archivo comprimido <code>.zip</code>, que contiene los archivos fuente utilizados para construir dicho informe, incluyendo datos tabulados, gr谩ficos en formato <code>.png</code> y un resumen en texto plano.
</p>

<p>
  Aunque es posible acceder a estos archivos directamente desde el visor interactivo que se presenta a continuaci贸n, se recomienda utilizar las secciones espec铆ficas por muestra situadas m谩s abajo. En dichas secciones, los informes <code>.html</code> se integran directamente en el documento mediante <code>iframe</code>, junto con un bot贸n de acceso para su visualizaci贸n ampliada. Adem谩s, se proporciona contexto adicional para facilitar la interpretaci贸n de los resultados individuales.
</p>

<div class="box-files">

```{r, results="asis"}
if (!dir.exists(ruta_Pre_fastqc_results)) {
  cat(sprintf('<p><em>La ruta "%s" no existe o no es accesible.</em></p>\n', ruta_Pre_fastqc_results_relativa))
} else {
  # Listar archivos con extensiones de inter茅s
  files <- list.files(ruta_Pre_fastqc_results_relativa, pattern = "\\.(html|zip|fastq\\.gz)$", full.names = FALSE)
  
  if (length(files) == 0) {
    cat('<p><em>No se encontraron archivos con las extensiones esperadas en la carpeta especificada.</em></p>\n')
  } else {
    enlace <- paste0("file://", ruta_Pre_fastqc_results_relativa)
    
    cat("<ul>\n")
    for (f in files) {
      # Asignar clase seg煤n la extensi贸n
      clase <- if (grepl("\\.html$", f)) {
        "file-html"
      } else if (grepl("\\.zip$", f)) {
        "file-zip"
      } else if (grepl("\\.fastq\\.gz$", f)) {
        "file-fastqgz"
      } else {
        "file-default"
      }
      
      cat(sprintf('<li class="%s"><a href="%s/%s" target="_blank">%s</a></li>\n',
                  clase, enlace, f, f))
    }
    cat("</ul>\n")
  }
}
```

</div>

```{r, echo=FALSE, results="asis"}
# Para que funcione con rutas absolutas
enlace <- paste0("file://", ruta_Pre_fastqc_results_relativa)

# Imprimir el enlace
cat(glue::glue('

<p style="text-align:center;">
  <a href="{enlace}" target="_blank" class="boton-files">
     Explora los archivos de la carpeta "Pre_fastqc_results" aqu铆
  </a>
</p>

<div style="height: 15px; background-color: transparent;"></div>
\n\n'))
```

<p>
  As铆, estos informes individuales generados por <strong>FastQC</strong> ofrecen una evaluaci贸n visual e interactiva de diversos aspectos clave de la calidad de las lecturas de secuenciaci贸n. Cada informe est谩 estructurado en m贸dulos que resumen m茅tricas espec铆ficas, facilitando as铆 la identificaci贸n de posibles problemas t茅cnicos o artefactos introducidos durante la preparaci贸n de las librer铆as o el proceso de secuenciaci贸n.
</p>

<div style="height: 5px; background-color: transparent;"></div>

---

<p>
  A continuaci贸n se describe brevemente la informaci贸n incluida en estos informes, accesibles, como ya hemos comentado, desde el visor interactivo anterior o m谩s adelante desde cada apartado espec铆fico.
</p>

<ul>
  <li><strong>Basic Statistics [<span style="color: green;">PASS</span> | <span style="color: orange;">WARNING</span> | <span style="color: red;">FAIL</span>]</strong>: Informaci贸n general sobre las secuencias, incluyendo el n煤mero total de lecturas, su longitud media y el contenido GC. Estos par谩metros permiten confirmar que los datos cumplen con los criterios b谩sicos de calidad esperados por la plataforma de secuenciaci贸n.</li>

  <li><strong>Per base sequence quality [<span style="color: green;">PASS</span> | <span style="color: orange;">WARNING</span> | <span style="color: red;">FAIL</span>]</strong>: Eval煤a la calidad de las bases en cada posici贸n de las lecturas. Una baja calidad al principio o final de las lecturas puede requerir recorte (trimming) para evitar errores en etapas posteriores.</li>

  <li><strong>Per tile sequence quality [<span style="color: green;">PASS</span> | <span style="color: orange;">WARNING</span> | <span style="color: red;">FAIL</span>]</strong>: Detecta anomal铆as en regiones espec铆ficas del flujo 贸ptico del secuenciador. Problemas en este m贸dulo pueden indicar fallos mec谩nicos o de iluminaci贸n que afectan localmente la calidad.</li>

  <li><strong>Per sequence quality scores [<span style="color: green;">PASS</span> | <span style="color: orange;">WARNING</span> | <span style="color: red;">FAIL</span>]</strong>: Muestra la distribuci贸n de puntuaciones de calidad para todas las lecturas. Una alta proporci贸n de lecturas con baja calidad puede comprometer el an谩lisis.</li>

  <li><strong>Per base sequence content [<span style="color: green;">PASS</span> | <span style="color: orange;">WARNING</span> | <span style="color: red;">FAIL</span>]</strong>: Analiza la proporci贸n de nucle贸tidos (A, T, G, C) en cada posici贸n. Desequilibrios importantes pueden reflejar sesgos de la librer铆a o contaminaci贸n.</li>

  <li><strong>Per sequence GC content [<span style="color: green;">PASS</span> | <span style="color: orange;">WARNING</span> | <span style="color: red;">FAIL</span>]</strong>: Eval煤a el contenido GC promedio por lectura. Desviaciones respecto al esperado para el organismo estudiado pueden indicar presencia de contaminantes o problemas en la preparaci贸n de la librer铆a.</li>

  <li><strong>Sequence Length Distribution [<span style="color: green;">PASS</span> | <span style="color: orange;">WARNING</span> | <span style="color: red;">FAIL</span>]</strong>: Muestra la distribuci贸n de longitudes de las lecturas. Una distribuci贸n uniforme o acorde con el protocolo indica buena calidad, mientras que distribuciones an贸malas pueden sugerir errores en el proceso de fragmentaci贸n o secuenciaci贸n.</li>

  <li><strong>Sequence Duplication Levels [<span style="color: green;">PASS</span> | <span style="color: orange;">WARNING</span> | <span style="color: red;">FAIL</span>]</strong>: Informa sobre la proporci贸n de lecturas duplicadas. Un alto nivel puede deberse a sobre-secuenciaci贸n, baja complejidad de la muestra o problemas en la PCR.</li>

  <li><strong>Overrepresented sequences [<span style="color: green;">PASS</span> | <span style="color: orange;">WARNING</span> | <span style="color: red;">FAIL</span>]</strong>: Identifica secuencias que aparecen con frecuencia anormalmente alta, como adaptadores no eliminados, contaminantes o secuencias ribosomales.</li>

  <li><strong>Adapter Content [<span style="color: green;">PASS</span> | <span style="color: orange;">WARNING</span> | <span style="color: red;">FAIL</span>]</strong>: Detecta la presencia de secuencias adaptadoras dentro de las lecturas. Si se detectan, es necesario aplicar un paso de recorte (trimming) antes de continuar con el an谩lisis.</li>
</ul>

<p>
  Cada m贸dulo es evaluado individualmente y clasificado como <span style="color: green;"><strong>PASS</strong></span>, <span style="color: orange;"><strong>WARNING</strong></span> o <span style="color: red;"><strong>FAIL</strong></span>. Un resultado <strong>PASS</strong> indica que el m贸dulo cumple con los criterios de calidad recomendados. <strong>WARNING</strong> se帽ala que se ha detectado una desviaci贸n leve o moderada que podr铆a afectar algunos an谩lisis dependiendo de la sensibilidad del downstream. <strong>FAIL</strong>, en cambio, indica problemas importantes que deber铆an ser corregidos o, al menos, tenidos en cuenta antes de continuar con el procesamiento de los datos.
</p>

<p>
  Dicho esto, en las siguientes subsecciones se analizar谩n en detalle los resultados de calidad, distinguiendo entre lecturas <em>forward</em> y <em>backward</em>. Dentro de cada una, se presentar谩 el informe individual correspondiente a cada muestra, integrado directamente en el documento para facilitar su consulta. Esta estructura permite una revisi贸n ordenada y completa del estado de las lecturas, asegurando que cada muestra sea evaluada con el nivel de detalle necesario antes de proceder con las etapas posteriores del an谩lisis.
</p>






<div style="height: 15px; background-color: transparent;"></div>

<div class="titulo3" id="tab3-seccion2.2.1">
  2.2.1. Evaluaci贸n de calidad de lecturas Forward
</div>

<p>
  En este apartado se muestran los resultados del an谩lisis de calidad correspondientes a las lecturas <strong>forward</strong> <em>(read 1)</em> de cada una de las muestras. Estas lecturas representan el primer extremo de los fragmentos secuenciados en protocolos <em>paired-end</em>, y su calidad es especialmente relevante para asegurar una alineaci贸n precisa y una cuantificaci贸n fiable en los pasos posteriores del an谩lisis transcript贸mico.
</p>

<p>
  A continuaci贸n, se incluyen las evaluaciones individuales para cada muestra, organizadas de forma estructurada para facilitar su revisi贸n. Esta presentaci贸n permite detectar con claridad posibles incidencias espec铆ficas en las lecturas <em>read 1</em>, como ca铆das de calidad en posiciones terminales, contaminaci贸n por adaptadores, sesgos en la composici贸n de bases o niveles an贸malos de duplicaci贸n. Identificar estos problemas a tiempo es crucial para garantizar la robustez y validez de los resultados obtenidos en las siguientes etapas del pipeline.
</p>

```{r}
# Obtener archivos .html de FastQC
archivos_html <- dir_ls(ruta_Pre_fastqc_results_relativa, regexp = "\\.html$")

# Extraer IDs de muestra
ids_muestras <- archivos_html |>
  path_file() |>
  str_replace("_fastqc\\.html$", "") |>
  str_remove("_(R1|R2)$") |>
  unique()
```

```{r, results='asis'}
for (id in ids_muestras) {

  # Construir ruta usando file.path
  ruta_fasqc_R1 <- file.path(ruta_Pre_fastqc_results_relativa, paste0(id, "_R1_fastqc.html"))

  # Contador
  i <- 1

  cat(glue::glue('
  <div class="titulo3" id="tab3-seccion2.2.1.{i}">
    2.2.1.{i}. Muestra: {id}
  </div>

  <p>
    A continuaci贸n se muestra el informe de control de calidad correspondiente a la lectura <strong>forward</strong> <em>(read 1)</em> de la muestra <strong>{id}</strong>. Este informe permite revisar visualmente distintos aspectos de calidad relacionados con las secuencias le铆das en el primer extremo de los fragmentos.
  </p>

  <iframe src="{ruta_fasqc_R1}" width="100%" height="700px" loading="lazy" style="border:none;"></iframe>

  <p style="text-align:center;">
    <a href="{ruta_fasqc_R1}" target="_blank" class="boton-iframe">
       Ver informe interactivo de FASTQC en una nueva p谩gina
    </a>
  </p>
  \n\n'))

  # Actualizar contador
  i <- i + 1
}
```






<div style="height: 15px; background-color: transparent;"></div>

<div class="titulo3" id="tab3-seccion2.2.2">
  2.2.2. Evaluaci贸n de calidad de lecturas Backward
</div>

<p>
  En esta secci贸n se presentan los resultados del an谩lisis de calidad correspondientes a las lecturas <strong>backward</strong> <em>(read 2)</em> de cada muestra. Estas lecturas representan el segundo extremo de los fragmentos secuenciados en protocolos <em>paired-end</em>, y complementan la informaci贸n proporcionada por las lecturas <em>forward</em> para una reconstrucci贸n m谩s completa de las transcripciones.
</p>

<p>
  A continuaci贸n, se muestran las evaluaciones individuales de calidad para las lecturas <em>read 2</em> por muestra, siguiendo el mismo formato estructurado que en el apartado anterior. Revisar cuidadosamente estos informes permite identificar posibles deficiencias espec铆ficas en las lecturas <em>backward</em>, como una menor calidad en las regiones finales, errores de secuenciaci贸n acumulativos o patrones inusuales en la distribuci贸n de bases. Estos aspectos son fundamentales para garantizar que ambas lecturas de cada fragmento contribuyan de forma fiable al an谩lisis global.
</p>

```{r, results='asis'}
for (id in ids_muestras) {

  # Construir ruta usando file.path
  ruta_fasqc_R2 <-file.path(ruta_Pre_fastqc_results_relativa, paste0(id, "_R2_fastqc.html"))

  # Contador
  i <- 1

  cat(glue::glue('
  <div class="titulo3" id="tab3-seccion2.2.2.{i}">
    2.2.2.{i}. Muestra: {id}
  </div>

  <p>
    A continuaci贸n se muestra el informe de control de calidad correspondiente a la lectura <strong>backward</strong> <em>(read 2)</em> de la muestra <strong>{id}</strong>. Este informe permite revisar visualmente diversos aspectos relacionados con la calidad de las secuencias obtenidas en el segundo extremo de los fragmentos, facilitando la detecci贸n de posibles incidencias que puedan comprometer el an谩lisis posterior.
  </p>

  <iframe src="{ruta_fasqc_R2}" width="100%" height="700px" loading="lazy" style="border:none;"></iframe>

  <p style="text-align:center;">
    <a href="{ruta_fasqc_R2}" target="_blank" class="boton-iframe">
       Ver informe interactivo de FASTQC en una nueva p谩gina
    </a>
  </p>
  \n\n'))

  # Actualizar contador
  i <- i + 1
}
```








<div style="height: 20px; background-color: transparent;"></div>

<div class="titulo2" id="tab3-seccion2.3">
  2.3. Reflexiones finales sobre el control de calidad
</div>

<p>
  <strong>驴Por qu茅 es fundamental realizar este control de calidad?</strong><br>

  Detectar tempranamente problemas como baja calidad en posiciones espec铆ficas, sesgos nucleot铆dicos o contaminaci贸n es esencial para garantizar resultados fiables en etapas posteriores como alineamiento y cuantificaci贸n g茅nica. Adaptadores residuales o exceso de secuencias duplicadas pueden introducir sesgos que comprometen la interpretaci贸n biol贸gica, generando falsos positivos o negativos.
</p>

<p>
  <strong>Conceptos clave a recordar:</strong>
</p>

<ul>
  <li><strong>Lecturas forward (read 1)</strong> y <strong>backward (read 2)</strong>: fragmentos secuenciados desde ambos extremos en la t茅cnica paired-end, que proporcionan un contexto m谩s completo para el an谩lisis.</li>
  <li><strong>M贸dulos de FastQC</strong>: m茅tricas y pruebas que permiten identificar problemas t茅cnicos o biol贸gicos en las lecturas.</li>
  <li><strong>MultiQC</strong>: herramienta que integra informes individuales para facilitar la detecci贸n global de anomal铆as.</li>
</ul>

<p>
  Este control de calidad integral es un pilar indispensable en cualquier pipeline de RNA-Seq, ya que maximiza la confianza en los datos y en los resultados biol贸gicos derivados.
</p>
