---
title: "Metagenomic Report"

include-in-header:
  text: |
    <link rel="shortcut icon" href="../../../../1-images/icons/favicon.svg"/>
    <link rel="icon" type="image/x-icon" href="../../../../1-images/icons/favicon.ico">

params:
  path_project: ""
  analysis_type: ""
  report_version: ""
---


<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  CHATBOT
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

```{=html}
<!-- Contenedor del chat -->
<div id="chat-container">
  <button id="chat-toggle"></button>
  <div id="chat-box">
    <div id="chat-info" class="chat-info">
      <h1>
        Mini Chat RAG (beta)
      </h1>

      <p>
        Este chat permite consultar de manera interactiva la informaci√≥n contenida en un informe espec√≠fico. 
        Para ello, se ha alimentado el sistema con el contenido del propio informe, junto con documentos externos en formato PDF y HTML, as√≠ como sesiones de preguntas y respuestas (QA). 
        Al formular una pregunta, el chat busca los fragmentos m√°s relevantes de todos estos documentos mediante t√©cnicas de procesamiento de lenguaje natural ligero y comparaciones basadas en similitud de vectores (medida de coseno). 
        A partir de los fragmentos seleccionados, se genera un resumen que intenta ofrecer una respuesta coherente y compacta a la consulta realizada.
      </p>

      <p>
        Se debe tener en cuenta que este entorno es de prueba. No se utilizan grandes modelos de lenguaje, por lo que las respuestas pueden ser aproximadas y no siempre completamente precisas. 
        El objetivo principal es proporcionar una visualizaci√≥n r√°pida y √∫til de la informaci√≥n contenida en los documentos, facilitando la exploraci√≥n del contenido del informe de manera interactiva.
      </p>
      
      <p>
        Actualmente, los resultados no son muy precisos debido al uso de modelos muy b√°sicos, seleccionados para que la aplicaci√≥n sea r√°pida y ejecutable en todo tipo de dispositivos sin necesidad de servidores externos. 
        Sin embargo, la base del sistema permite mejorar notablemente los resultados en el futuro mediante el uso de modelos m√°s potentes o la integraci√≥n con APIs externas, ofreciendo as√≠ un rendimiento y precisi√≥n significativamente superiores.
        Para iniciar, basta con escribir su pregunta en el campo de texto inferior.
      </p>
    </div>
    <div id="chat-log"></div>
    <input id="chat-input" type="text" placeholder="Escribe tu pregunta..."/>
    <button id="chat-send" title="Enviar">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M2 21l21-9L2 3v7l15 2-15 2v7z"/>
      </svg>
    </button>
  </div>
</div>
```









<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  TAB 1: INICIO -->
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

<div class="informe-titulo-tab">
  <h1>Pesta√±a</h1>
  <h2>Metodolog√≠a y Herramientas</h2>
</div>

<div class="flecha-abajo">
  ‚ñº
</div>


<div class="informe-resumen">

<h2>Contexto y pipelines empleados</h2>

<p>
  La <strong>metagen√≥mica de amplicones</strong> es un enfoque utilizado para estudiar la composici√≥n y diversidad de comunidades microbianas sin necesidad de aislar organismos individuales. 
  Se basa en la secuenciaci√≥n de regiones conservadas de genes marcador, que permiten identificar taxones presentes en una muestra ambiental, cl√≠nica o experimental. 
    Los marcadores m√°s habituales son:
</p>

<ul>
  <li><strong>16S rRNA</strong>: utilizado para identificar bacterias y arqueas. Es el enfoque principal de este informe.</li>
  <li><strong>18S rRNA</strong>: utilizado para caracterizar eucariotas (protozoos, hongos y otros microeucariotas), planeado para futuras extensiones del estudio.</li>
  <li><strong>ITS (Internal Transcribed Spacer)</strong>: utilizado principalmente para identificaci√≥n de hongos a nivel de especie, tambi√©n considerado para futuras ampliaciones.</li>
</ul>

<p>
  Este informe se centra en el an√°lisis de <strong>16S</strong>, mientras que los datos de <strong>18S e ITS</strong> quedan comentados y mencionados para posibles ampliaciones en nuevas pesta√±as del informe, permitiendo una extensi√≥n del estudio de forma modular y reproducible.
</p>

<p>
    Los datos utilizados en este informe provienen de:
</p>

<ul>
  <li><strong>Control de calidad inicial</strong>: realizado mediante <strong>miARma‚ÄëSeq</strong> (<em>Eduardo Andr√©s-Le√≥n et al.</em>), un pipeline modular y completo dise√±ado para an√°lisis de RNA-Seq que incluye pasos de recorte, alineamiento, cuantificaci√≥n y an√°lisis diferencial. 
  Dado que miARma‚ÄëSeq no est√° pensado espec√≠ficamente para metagen√≥mica, en este informe se ha utilizado √∫nicamente para procesar datos de <code>FASTQ</code> y generar informes de <em>FastQC</em> y <em>MultiQC</em> para evaluar la calidad de las lecturas. 
  Toda la informaci√≥n y documentaci√≥n de miARma-Seq est√° disponible en su <a href="https://github.com/eandresleon/miARma-seq" class="normalink" target="_blank">repositorio oficial</a>.</li>
  
  <li><strong>An√°lisis metagen√≥mico principal</strong>: llevado a cabo con <strong>QIIME2</strong>, que permite denoising de lecturas, construcci√≥n de tablas de abundancia, c√°lculo de m√©tricas de diversidad, an√°lisis funcional y visualizaci√≥n integrada. 
  QIIME2 es una plataforma reproducible y documentada, dise√±ada espec√≠ficamente para metagen√≥mica de amplicones, disponible en <a href="https://qiime2.org/" class="normalink" target="_blank">https://qiime2.org/</a>.</li>
</ul>

<p>
  Para ambas herramientas, m√°s adelante se comentar√° el pipeline completo de manera detallada, incluyendo todos los pasos posibles y su integraci√≥n en el flujo de trabajo automatizado de este informe.
</p>

<p>
  El flujo de trabajo completo combina estas herramientas de la siguiente manera:
</p>

<ol>
  <li><strong>Control de calidad inicial</strong>: evaluaci√≥n de lecturas crudas mediante <em>FastQC</em> y res√∫menes globales con <em>MultiQC</em> generados por <strong>miARma‚ÄëSeq</strong>.</li>
  <li><strong>Procesamiento metagen√≥mico</strong>: an√°lisis exclusivo de <strong>16S</strong> con <em>QIIME2</em>, incluyendo filtrado, denoising con <em>DADA2</em>, generaci√≥n de tablas de abundancia y visualizaciones preliminares.</li>
  <li><strong>An√°lisis de diversidad y funcionalidad</strong>: c√°lculo de m√©tricas Œ± y Œ≤ de diversidad, visualizaciones con PCoA, predicci√≥n funcional de metagenomas mediante <em>PICRUSt2</em> y an√°lisis estad√≠stico con <em>R</em> usando paquetes como <em>MetagenomeSeq</em> o <em>ALDEx2</em>.</li>
  <li><strong>Informe automatizado</strong>: integraci√≥n de todos los resultados en un reporte reproducible en <strong>HTML</strong> mediante <strong>Quarto</strong>, incluyendo gr√°ficos, tablas y res√∫menes de cada etapa.</li>
</ol>

<p>
    Como ya se ha mencionado, por el momento, los an√°lisis de <strong>18S e ITS</strong> se encuentran comentados y mencionados √∫nicamente como referencia. Estas secciones podr√°n incorporarse en futuras pesta√±as del informe, manteniendo la misma estructura modular y reproducible que caracteriza el pipeline.
</p>

<table style="width:100%; border-collapse: collapse; margin-top: 1.5em;">
    <thead>
        <tr style="background-color: #f2f2f2;">
        <th style="border: 1px solid #ddd; padding: 8px;">Caracter√≠stica</th>
        <th style="border: 1px solid #ddd; padding: 8px;">Beneficio</th>
        </tr>
    </thead>
    <tbody>
        <tr>
        <td style="border: 1px solid #ddd; padding: 8px;"><strong>Automatizaci√≥n</strong></td>
        <td style="border: 1px solid #ddd; padding: 8px;">Permite generar informes reproducibles sin intervenci√≥n manual en cada paso.</td>
        </tr>
        <tr>
        <td style="border: 1px solid #ddd; padding: 8px;"><strong>Modularidad</strong></td>
        <td style="border: 1px solid #ddd; padding: 8px;">Cada etapa del flujo (QC, denoising, diversidad, funcionalidad) puede ejecutarse de forma independiente o completa.</td>
        </tr>
        <tr>
        <td style="border: 1px solid #ddd; padding: 8px;"><strong>Integraci√≥n QIIME2 + R</strong></td>
        <td style="border: 1px solid #ddd; padding: 8px;">Permite combinar an√°lisis bioinform√°tico y estad√≠stico con visualizaci√≥n reproducible.</td>
        </tr>
        <tr>
        <td style="border: 1px solid #ddd; padding: 8px;"><strong>Flexibilidad</strong></td>
        <td style="border: 1px solid #ddd; padding: 8px;">Se puede ampliar el estudio a otros marcadores (18S, ITS) en el futuro, creando nuevas pesta√±as en el informe.</td>
        </tr>
    </tbody>
</table>

</div>


<div style="height: 5px; background-color: transparent;"></div>

<p>
  A continuaci√≥n se presentan los flujos de trabajo de las dos herramientas principales utilizadas en este an√°lisis de metagen√≥mica: <strong>miARma‚ÄëSeq</strong> para control de calidad y <strong>QIIME2</strong> para el an√°lisis de datos de 16S. Cada diagrama ilustra la modularidad y reproducibilidad del pipeline.
</p>






<div style="height: 13px; background-color: transparent;"></div>

<div class="titulo4">
  ‚û§ Flujo de trabajo con miARma-Seq
</div>

<p>
  <strong>miARma‚ÄëSeq</strong> es un pipeline integral dise√±ado para an√°lisis de RNA‚ÄëSeq (mRNA, miRNA y circRNA), desarrollado por <em>Eduardo Andr√©s‚ÄëLe√≥n et al.</em>. Incluye m√∫ltiples m√≥dulos que permiten procesar datos crudos de manera modular y reproducible:
</p>

<ol>
  <li><strong>Control de calidad inicial:</strong> Evaluaci√≥n de archivos <code>FASTQ</code> mediante <em>FastQC</em>, con generaci√≥n de reportes individuales y res√∫menes globales usando <em>MultiQC</em>, permitiendo detectar adaptadores, sesgos de composici√≥n y problemas de calidad por posici√≥n.</li>
  <li><strong>Recorte de lecturas:</strong> Eliminaci√≥n de adaptadores y bases de baja calidad mediante <em>Cutadapt</em> o <em>Reaper</em>, optimizando los datos antes de alineamiento.</li>
  <li><strong>Alineamiento:</strong> Mapeo contra genomas de referencia usando alineadores como <em>HISAT2</em>, <em>STAR</em>, <em>Bowtie</em> o <em>BWA</em>, dependiendo del tipo de RNA.</li>
  <li><strong>Cuantificaci√≥n:</strong> Conteo de genes o isoformas con <em>featureCounts</em>, detecci√≥n de circRNAs con <em>CIRI</em> y cuantificaci√≥n de miRNAs con <em>miRDeep2</em>.</li>
  <li><strong>An√°lisis diferencial:</strong> Identificaci√≥n de genes o miRNAs diferencialmente expresados mediante <em>edgeR</em> o <em>NOISeq</em>, seg√∫n el dise√±o experimental.</li>
  <li><strong>An√°lisis funcional:</strong> Predicci√≥n de interacciones miRNA‚ÄëmRNA, correlaciones inversas de expresi√≥n y an√°lisis de enriquecimiento funcional (GO, KEGG).</li>
</ol>

<p>
  Aunque miARma‚ÄëSeq ofrece todas estas funcionalidades, en este informe √∫nicamente se ha utilizado el <strong>m√≥dulo de control de calidad</strong> para los archivos <code>FASTQ</code> de nuestro an√°lisis metagen√≥mico. Esto garantiza que las lecturas crudas de 16S sean de alta calidad antes de ser procesadas con QIIME2. Toda la documentaci√≥n y el repositorio de miARma‚ÄëSeq est√°n disponibles en su repoditorio de <a href="https://github.com/eandresleon/miARma-seq" class="normalink" target="_blank">GitHub</a>. Podemos ver el workflow completo de esta herramienta a continuaci√≥n:
</p>

<div class="box-images">
  <img src="../../../../1-images/tab0-inicio/miARma-Seq-workflow.png" alt="Pipeline completo de miARma-Seq">
</div>

<p>
  Para garantizar la <strong>reproducibilidad</strong> y <strong>modularidad</strong> del pipeline, <code>miARma‚ÄëSeq</code> utiliza un archivo de configuraci√≥n con extensi√≥n <code>.ini</code>. Este archivo permite especificar todos los par√°metros necesarios para ejecutar el pipeline completo de RNA-Seq, sin necesidad de escribir comandos complejos en la l√≠nea de comandos. En el contexto de este informe de metagen√≥mica, se ha utilizado √∫nicamente el m√≥dulo de control de calidad de lecturas (<code>FASTQ</code>), aunque el archivo <code>.ini</code> podr√≠a activar otros pasos del pipeline si se deseara.
</p>

<p>
  El archivo <code>.ini</code> se organiza en secciones bien definidas (por ejemplo, <code>[General]</code>, <code>[QC]</code>, <code>[Aligner]</code>, <code>[ReadCount]</code>‚Ä¶), cada una dedicada a un m√≥dulo espec√≠fico del pipeline de miARma‚ÄëSeq. En cada secci√≥n se indican rutas de entrada y salida, tipo de datos, n√∫mero de hilos, herramientas a utilizar y criterios estad√≠sticos.
</p>

<p>
  A continuaci√≥n se muestra un ejemplo real de un archivo <code>.ini</code> de miARma‚ÄëSeq, incluyendo los m√≥dulos de control de calidad, alineamiento, cuantificaci√≥n y an√°lisis diferencial para datos de RNA. En este informe, solo se ejecuta el m√≥dulo de <strong>QC</strong>:
</p>

<iframe src="resources/1-essential/2-archives/tab0-inicio/miARma_mRNAs_pipeline_STAR.txt" width="100%" height="500px" frameborder="0" style="border: none; display: block;"></iframe>

<p style="text-align:center;">
  <a href="../../../../2-archives/tab0-inicio/miARma_mRNAs_pipeline_STAR.txt" target="_blank" class="boton-iframe">
    üîç Ver archivo completo en una nueva p√°gina
  </a>
</p>

<p>
  Este archivo se ejecuta mediante el siguiente comando, una vez realizada la instalaci√≥n y configuraci√≥n de <code>miARma‚ÄëSeq</code>:
</p>

```bash
./miARma miarma_config_example.ini check
```

<p>
  Para m√°s informaci√≥n sobre esta herramienta y su pipeline completo, se puede consultar el repositorio oficial en <a href="https://github.com/eandresleon/miARma-seq" class="normalink" target="_blank" class="normalink">GitHub: miARma‚ÄëSeq</a>.  
  En futuras extensiones del an√°lisis metagen√≥mico, se podr√≠a aprovechar m√°s m√≥dulos del pipeline si se integran otros tipos de datos o se desea automatizar pasos adicionales.
</p>








<div style="height: 13px; background-color: transparent;"></div>

<div class="titulo4">
  ‚û§ Flujo de trabajo con QIIME2
</div>

<p>
  <strong>QIIME2</strong> es una plataforma especializada para an√°lisis de metagen√≥mica de amplicones, especialmente del marcador 16S, con un enfoque modular, reproducible y documentado. Su flujo de trabajo incluye m√∫ltiples etapas que permiten procesar, filtrar y analizar las secuencias de manera rigurosa, integrando herramientas estad√≠sticas y visualizaci√≥n avanzada.
</p>

<ol>
  <li>
    <strong>Secuencias crudas (.fastq)</strong>: Se importan los archivos de secuenciaci√≥n sin procesar, que contienen todas las lecturas de ADN de las muestras.
  </li>
  <li>
    <strong>Validaci√≥n del archivo de metadatos</strong>: Se comprueba que la informaci√≥n de cada muestra (por ejemplo, grupos experimentales) est√© correctamente formateada y consistente con los datos de secuenciaci√≥n.
  </li>
  <li>
    <strong>Importaci√≥n de secuencias</strong>: Conversi√≥n de los archivos <code>.fastq</code> al formato nativo de QIIME2, que permite la ejecuci√≥n de los siguientes pasos del pipeline.
  </li>
  <li>
    <strong>Demultiplexing</strong>: Separaci√≥n de lecturas por muestra utilizando los √≠ndices o c√≥digos de barras, asignando cada secuencia a su muestra de origen.
  </li>
  <li>
    <strong>Filtrado de calidad, eliminaci√≥n de quimeras y desreplicaci√≥n</strong>: Se eliminan secuencias de baja calidad y quim√©ricas (artefactos de PCR), y se generan secuencias √∫nicas (ASVs, Amplicon Sequence Variants) que representan las variantes biol√≥gicas reales.
  </li>
  <li>
    <strong>Asignaci√≥n taxon√≥mica</strong>: Cada ASV se clasifica en niveles taxon√≥micos (especie, g√©nero, familia, etc.) usando bases de referencia.
  </li>
  <li>
    <strong>Entrenamiento de la base de datos</strong>: Se entrena un clasificador de aprendizaje autom√°tico con bases de referencia (como SILVA o Greengenes) para mejorar la precisi√≥n de la asignaci√≥n taxon√≥mica.
  </li>
  <li>
    <strong>Visualizaci√≥n de la taxonom√≠a</strong>: Se generan gr√°ficos que muestran la composici√≥n microbiana de cada muestra y del conjunto de datos.
  </li>
  <li>
    <strong>Creaci√≥n de √°rbol filogen√©tico</strong>: Se construye un √°rbol filogen√©tico que representa las relaciones evolutivas entre los ASVs, esencial para an√°lisis de diversidad basados en distancia filogen√©tica.
  </li>
  <li>
    <strong>An√°lisis de diversidad alfa y beta</strong>: C√°lculo de m√©tricas de diversidad alfa (dentro de cada muestra) y beta (entre muestras) para comparar la riqueza, uniformidad y composici√≥n de las comunidades microbianas.
  </li>
  <li>
    <strong>Exportaci√≥n de resultados</strong>: Las tablas de ASVs, la asignaci√≥n taxon√≥mica y las m√©tricas de diversidad se exportan a formatos compatibles con R u otros programas, facilitando an√°lisis estad√≠sticos, visualizaciones avanzadas y predicciones funcionales.
  </li>
</ol>

<p>
  Mediante la siguiente imagen podemos observar de forma m√°s visual el workflow completo descrito anteriormente y seguido con esta herramienta:
</p>

<div class="box-images">
  <img src="../../../../1-images/tab0-inicio/miARma-Seq-workflow.png" alt="Pipeline de QIIME2">
</div>

<p>
  El uso combinado de <strong>QIIME2</strong> y <strong>R</strong> permite un an√°lisis completo y reproducible de los datos de 16S, integrando diversidad, funcionalidad y estad√≠stica avanzada. La documentaci√≥n oficial de QIIME2 est√° disponible en <a href="https://qiime2.org/" target="_blank" class="normalink">https://qiime2.org/</a>.
</p>

<p>
  En conjunto, ambos pipelines ‚ÄîmiARma‚ÄëSeq para control de calidad y QIIME2 para an√°lisis metagen√≥mico‚Äî se integran mediante <strong>Nextflow</strong> para generar un informe reproducible en <strong>Quarto</strong>. Esto asegura trazabilidad, modularidad y claridad en la interpretaci√≥n de los resultados.
</p>






<div style="height: 13px; background-color: transparent;"></div>

<div class="titulo4">
  ‚û§ Reflexiones finales
</div>

<p>
  Con los datos procesados mediante <strong>miARma‚ÄëSeq</strong> para control de calidad y <strong>QIIME2</strong> para el an√°lisis metagen√≥mico, se ha generado el correspondiente informe automatizado de metagen√≥mica mediante un pipeline reproducible desarrollado en <strong>Nextflow</strong>. 
</p>

<p>
  Este informe se organiza en tres pesta√±as principales para facilitar la navegaci√≥n y la interpretaci√≥n de resultados:
</p>

<ol>
  <li><strong>Inicio</strong>: Esta pesta√±a, donde se describe el contexto, las herramientas empleadas, los pipelines y la filosof√≠a de reproducibilidad del an√°lisis.</li>
  <li><strong>Resumen</strong>: Contiene las m√©tricas principales de calidad y an√°lisis, la fecha de creaci√≥n del documento y un resumen de los resultados m√°s relevantes.</li>
  <li><strong>An√°lisis</strong>: Aqu√≠ se presenta todo el proceso de metagen√≥mica, incluyendo gr√°ficos, tablas de abundancia, m√©tricas de diversidad y an√°lisis estad√≠sticos.  
    En realidad, esta secci√≥n est√° dividida en tres pesta√±as espec√≠ficas: <strong>An√°lisis 16S</strong>, <strong>An√°lisis 18S</strong> y <strong>An√°lisis ITS</strong>, pero en el presente informe nos centraremos principalmente en el an√°lisis de 16S.
  </li>
</ol>

<p>
  El usuario puede navegar entre estas pesta√±as de manera interactiva mediante la barra de men√∫ superior del informe, accediendo a la informaci√≥n general, los res√∫menes principales y los an√°lisis detallados de cada marcador seg√∫n convenga.
</p>










<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  CARGAR JAVASCRIPT PARA CHATBOT
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

<!-- Script exclusivo del chat -->
<script type="module" src="../../../4-javascript/chatbot.js"></script>
